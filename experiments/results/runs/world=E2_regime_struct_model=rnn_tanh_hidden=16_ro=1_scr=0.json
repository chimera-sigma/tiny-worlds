{
  "metadata": {
    "timestamp": "2025-11-27T20:00:13.718010",
    "world_id": "E2_regime_struct",
    "world_type": "regime_markov",
    "model_id": "rnn_tanh",
    "model_type": "rnn_tanh",
    "time_cond_type": "full_time",
    "readout_only": true,
    "scramble_core": false,
    "n_seeds": 20,
    "master_seed": 1234,
    "device": "cuda",
    "output_dir": "D:\\tiny_world_model"
  },
  "hyperparameters": {
    "hidden_dim": 16,
    "learning_rate": 0.001,
    "batch_size": 64,
    "max_steps": 20000,
    "n_train_seqs": 20000,
    "n_eval_seqs": 2000,
    "sequence_length": 128
  },
  "per_seed_results": [
    {
      "seed": 1234,
      "seed_index": 0,
      "avg_nll_model": 36.18332169660433,
      "avg_nll_baseline": 47.533384750246064,
      "delta_nll": 11.350063053641733,
      "n_eval_samples": 254000,
      "probe_r2_trained": 0.003076522247769886,
      "probe_mse_trained": 0.24923180043697357,
      "probe_r2_random": 1.1128794488168836e-06,
      "probe_mse_random": 0.25000065565109253,
      "probe_r2_permuted": -0.006376083452419579,
      "probe_mse_permuted": 0.2515949606895447
    },
    {
      "seed": 1235,
      "seed_index": 1,
      "avg_nll_model": 35.231150221456694,
      "avg_nll_baseline": 47.533384750246064,
      "delta_nll": 12.30223452878937,
      "n_eval_samples": 254000,
      "probe_r2_trained": -0.0037449058421870074,
      "probe_mse_trained": 0.25093716382980347,
      "probe_r2_random": 6.524723765399809e-05,
      "probe_mse_random": 0.24998462200164795,
      "probe_r2_permuted": -0.030429209582785832,
      "probe_mse_permuted": 0.2576082646846771
    },
    {
      "seed": 1236,
      "seed_index": 2,
      "avg_nll_model": 36.1901508058563,
      "avg_nll_baseline": 47.533384750246064,
      "delta_nll": 11.343233944389766,
      "n_eval_samples": 254000,
      "probe_r2_trained": -0.008917616011777874,
      "probe_mse_trained": 0.25223034620285034,
      "probe_r2_random": 2.7934869404444562e-05,
      "probe_mse_random": 0.2499939501285553,
      "probe_r2_permuted": -0.002719471363969328,
      "probe_mse_permuted": 0.2506808042526245
    },
    {
      "seed": 1237,
      "seed_index": 3,
      "avg_nll_model": 35.18299793922244,
      "avg_nll_baseline": 47.533384750246064,
      "delta_nll": 12.350386811023625,
      "n_eval_samples": 254000,
      "probe_r2_trained": 0.021390338571836698,
      "probe_mse_trained": 0.24465332925319672,
      "probe_r2_random": 3.9259709608052695e-05,
      "probe_mse_random": 0.24999111890792847,
      "probe_r2_permuted": -0.0054894080689060765,
      "probe_mse_permuted": 0.251373291015625
    },
    {
      "seed": 1238,
      "seed_index": 4,
      "avg_nll_model": 34.830641178641734,
      "avg_nll_baseline": 47.533384750246064,
      "delta_nll": 12.70274357160433,
      "n_eval_samples": 254000,
      "probe_r2_trained": 0.002861171470636692,
      "probe_mse_trained": 0.24928563833236694,
      "probe_r2_random": 6.6856557051298e-05,
      "probe_mse_random": 0.24998421967029572,
      "probe_r2_permuted": -0.0036147297842687998,
      "probe_mse_permuted": 0.2509046196937561
    },
    {
      "seed": 1239,
      "seed_index": 5,
      "avg_nll_model": 36.34980124261811,
      "avg_nll_baseline": 47.533384750246064,
      "delta_nll": 11.18358350762795,
      "n_eval_samples": 254000,
      "probe_r2_trained": -0.004311863105428637,
      "probe_mse_trained": 0.25107890367507935,
      "probe_r2_random": 3.741197252216111e-05,
      "probe_mse_random": 0.24999158084392548,
      "probe_r2_permuted": -0.0020482063620113067,
      "probe_mse_permuted": 0.2505129873752594
    },
    {
      "seed": 1240,
      "seed_index": 6,
      "avg_nll_model": 35.01057344980315,
      "avg_nll_baseline": 47.533384750246064,
      "delta_nll": 12.522811300442918,
      "n_eval_samples": 254000,
      "probe_r2_trained": -0.006784254535123324,
      "probe_mse_trained": 0.25169700384140015,
      "probe_r2_random": 6.947915162480722e-05,
      "probe_mse_random": 0.24998356401920319,
      "probe_r2_permuted": -0.002054166804223767,
      "probe_mse_permuted": 0.2505144774913788
    },
    {
      "seed": 1241,
      "seed_index": 7,
      "avg_nll_model": 36.6299508796752,
      "avg_nll_baseline": 47.533384750246064,
      "delta_nll": 10.903433870570865,
      "n_eval_samples": 254000,
      "probe_r2_trained": -0.005396782796925681,
      "probe_mse_trained": 0.25135013461112976,
      "probe_r2_random": 7.865823263186744e-05,
      "probe_mse_random": 0.24998126924037933,
      "probe_r2_permuted": -0.0035440389396299565,
      "probe_mse_permuted": 0.2508869469165802
    },
    {
      "seed": 1242,
      "seed_index": 8,
      "avg_nll_model": 35.07908710629921,
      "avg_nll_baseline": 47.533384750246064,
      "delta_nll": 12.454297643946852,
      "n_eval_samples": 254000,
      "probe_r2_trained": 0.005881983188292361,
      "probe_mse_trained": 0.24853043258190155,
      "probe_r2_random": 3.472977352658724e-05,
      "probe_mse_random": 0.2499922513961792,
      "probe_r2_permuted": -0.002029371364620225,
      "probe_mse_permuted": 0.25050827860832214
    },
    {
      "seed": 1243,
      "seed_index": 9,
      "avg_nll_model": 36.14972373277559,
      "avg_nll_baseline": 47.533384750246064,
      "delta_nll": 11.383661017470473,
      "n_eval_samples": 254000,
      "probe_r2_trained": -0.006870204111825817,
      "probe_mse_trained": 0.2517184913158417,
      "probe_r2_random": 4.1941908603626565e-05,
      "probe_mse_random": 0.24999044835567474,
      "probe_r2_permuted": -0.007087402626044792,
      "probe_mse_permuted": 0.25177279114723206
    },
    {
      "seed": 1244,
      "seed_index": 10,
      "avg_nll_model": 35.54335294660433,
      "avg_nll_baseline": 47.533384750246064,
      "delta_nll": 11.990031803641735,
      "n_eval_samples": 254000,
      "probe_r2_trained": -0.02694461585658492,
      "probe_mse_trained": 0.2567371129989624,
      "probe_r2_random": -7.944620592503782e-07,
      "probe_mse_random": 0.25000113248825073,
      "probe_r2_permuted": -0.02901670398729639,
      "probe_mse_permuted": 0.2572551369667053
    },
    {
      "seed": 1245,
      "seed_index": 11,
      "avg_nll_model": 35.41130674827756,
      "avg_nll_baseline": 47.533384750246064,
      "delta_nll": 12.122078001968504,
      "n_eval_samples": 254000,
      "probe_r2_trained": 0.0018777581100162255,
      "probe_mse_trained": 0.24953149259090424,
      "probe_r2_random": 6.608169956368037e-05,
      "probe_mse_random": 0.24998441338539124,
      "probe_r2_permuted": -0.0008438394085781287,
      "probe_mse_permuted": 0.2502118945121765
    },
    {
      "seed": 1246,
      "seed_index": 12,
      "avg_nll_model": 35.44085845226378,
      "avg_nll_baseline": 47.533384750246064,
      "delta_nll": 12.092526297982282,
      "n_eval_samples": 254000,
      "probe_r2_trained": -0.005975064900370697,
      "probe_mse_trained": 0.25149470567703247,
      "probe_r2_random": -6.302147875647535e-05,
      "probe_mse_random": 0.2500166893005371,
      "probe_r2_permuted": -0.0010040560952466748,
      "probe_mse_permuted": 0.2502519488334656
    },
    {
      "seed": 1247,
      "seed_index": 13,
      "avg_nll_model": 34.9545256828248,
      "avg_nll_baseline": 47.533384750246064,
      "delta_nll": 12.578859067421263,
      "n_eval_samples": 254000,
      "probe_r2_trained": -0.04036574358619838,
      "probe_mse_trained": 0.2600924074649811,
      "probe_r2_random": 9.636311812499798e-06,
      "probe_mse_random": 0.2499985247850418,
      "probe_r2_permuted": -0.0035082762863556383,
      "probe_mse_permuted": 0.2508780062198639
    },
    {
      "seed": 1248,
      "seed_index": 14,
      "avg_nll_model": 35.759883827509846,
      "avg_nll_baseline": 47.533384750246064,
      "delta_nll": 11.773500922736218,
      "n_eval_samples": 254000,
      "probe_r2_trained": -0.0010379114070131479,
      "probe_mse_trained": 0.2502604126930237,
      "probe_r2_random": 8.718166499555036e-05,
      "probe_mse_random": 0.2499791383743286,
      "probe_r2_permuted": -0.0025852422053467272,
      "probe_mse_permuted": 0.25064724683761597
    },
    {
      "seed": 1249,
      "seed_index": 15,
      "avg_nll_model": 35.101023160679134,
      "avg_nll_baseline": 47.533384750246064,
      "delta_nll": 12.43236158956693,
      "n_eval_samples": 254000,
      "probe_r2_trained": 0.00037781282727111787,
      "probe_mse_trained": 0.2499064803123474,
      "probe_r2_random": 5.416081513898163e-05,
      "probe_mse_random": 0.24998739361763,
      "probe_r2_permuted": -0.002376269101380668,
      "probe_mse_permuted": 0.25059500336647034
    },
    {
      "seed": 1250,
      "seed_index": 16,
      "avg_nll_model": 35.56264047121063,
      "avg_nll_baseline": 47.533384750246064,
      "delta_nll": 11.970744279035436,
      "n_eval_samples": 254000,
      "probe_r2_trained": -0.004062716620951035,
      "probe_mse_trained": 0.25101661682128906,
      "probe_r2_random": 4.0809424583176934e-05,
      "probe_mse_random": 0.24999073147773743,
      "probe_r2_permuted": -0.002493093768743293,
      "probe_mse_permuted": 0.2506242096424103
    },
    {
      "seed": 1251,
      "seed_index": 17,
      "avg_nll_model": 35.3427624261811,
      "avg_nll_baseline": 47.533384750246064,
      "delta_nll": 12.190622324064961,
      "n_eval_samples": 254000,
      "probe_r2_trained": -0.007865955587825768,
      "probe_mse_trained": 0.2519674301147461,
      "probe_r2_random": -0.0001308513111333287,
      "probe_mse_random": 0.2500336468219757,
      "probe_r2_permuted": -0.01208749838916523,
      "probe_mse_permuted": 0.25302281975746155
    },
    {
      "seed": 1252,
      "seed_index": 18,
      "avg_nll_model": 35.072795060285436,
      "avg_nll_baseline": 47.533384750246064,
      "delta_nll": 12.460589689960628,
      "n_eval_samples": 254000,
      "probe_r2_trained": -0.003715222839969501,
      "probe_mse_trained": 0.25092974305152893,
      "probe_r2_random": 6.781022780533164e-05,
      "probe_mse_random": 0.2499839812517166,
      "probe_r2_permuted": -0.002997108762222034,
      "probe_mse_permuted": 0.25075021386146545
    },
    {
      "seed": 1253,
      "seed_index": 19,
      "avg_nll_model": 35.411541031003935,
      "avg_nll_baseline": 47.533384750246064,
      "delta_nll": 12.121843719242129,
      "n_eval_samples": 254000,
      "probe_r2_trained": -0.0006905368348757435,
      "probe_mse_trained": 0.25017356872558594,
      "probe_r2_random": -9.973780278471622e-05,
      "probe_mse_random": 0.2500258684158325,
      "probe_r2_permuted": -0.02613459175992272,
      "probe_mse_permuted": 0.256534606218338
    }
  ],
  "aggregated_metrics": {
    "delta_nll": {
      "mean": 12.011480347256398,
      "std": 0.5073822534822019,
      "min": 10.903433870570865,
      "max": 12.70274357160433,
      "values": [
        11.350063053641733,
        12.30223452878937,
        11.343233944389766,
        12.350386811023625,
        12.70274357160433,
        11.18358350762795,
        12.522811300442918,
        10.903433870570865,
        12.454297643946852,
        11.383661017470473,
        11.990031803641735,
        12.122078001968504,
        12.092526297982282,
        12.578859067421263,
        11.773500922736218,
        12.43236158956693,
        11.970744279035436,
        12.190622324064961,
        12.460589689960628,
        12.121843719242129
      ]
    },
    "probe_r2_trained": {
      "mean": -0.004560890381061727,
      "std": 0.011867527587487143,
      "values": [
        0.003076522247769886,
        -0.0037449058421870074,
        -0.008917616011777874,
        0.021390338571836698,
        0.002861171470636692,
        -0.004311863105428637,
        -0.006784254535123324,
        -0.005396782796925681,
        0.005881983188292361,
        -0.006870204111825817,
        -0.02694461585658492,
        0.0018777581100162255,
        -0.005975064900370697,
        -0.04036574358619838,
        -0.0010379114070131479,
        0.00037781282727111787,
        -0.004062716620951035,
        -0.007865955587825768,
        -0.003715222839969501,
        -0.0006905368348757435
      ]
    },
    "probe_r2_random": {
      "mean": 2.4695369062055493e-05,
      "std": 5.767645021071461e-05,
      "values": [
        1.1128794488168836e-06,
        6.524723765399809e-05,
        2.7934869404444562e-05,
        3.9259709608052695e-05,
        6.6856557051298e-05,
        3.741197252216111e-05,
        6.947915162480722e-05,
        7.865823263186744e-05,
        3.472977352658724e-05,
        4.1941908603626565e-05,
        -7.944620592503782e-07,
        6.608169956368037e-05,
        -6.302147875647535e-05,
        9.636311812499798e-06,
        8.718166499555036e-05,
        5.416081513898163e-05,
        4.0809424583176934e-05,
        -0.0001308513111333287,
        6.781022780533164e-05,
        -9.973780278471622e-05
      ]
    },
    "probe_r2_permuted": {
      "mean": -0.007421938405656858,
      "std": 0.009228916364725294,
      "values": [
        -0.006376083452419579,
        -0.030429209582785832,
        -0.002719471363969328,
        -0.0054894080689060765,
        -0.0036147297842687998,
        -0.0020482063620113067,
        -0.002054166804223767,
        -0.0035440389396299565,
        -0.002029371364620225,
        -0.007087402626044792,
        -0.02901670398729639,
        -0.0008438394085781287,
        -0.0010040560952466748,
        -0.0035082762863556383,
        -0.0025852422053467272,
        -0.002376269101380668,
        -0.002493093768743293,
        -0.01208749838916523,
        -0.002997108762222034,
        -0.02613459175992272
      ]
    },
    "probe_emergence_margin": {
      "description": "trained R\u00b2 minus max(random, permuted) R\u00b2",
      "mean": -0.004585585750123783,
      "values": [
        0.0030754093683210693,
        -0.0038101530798410055,
        -0.008945550881182318,
        0.021351078862228645,
        0.002794314913585394,
        -0.004349275077950798,
        -0.006853733686748131,
        -0.005475441029557548,
        0.005847253414765774,
        -0.006912146020429444,
        -0.02694382139452567,
        0.0018116764104525451,
        -0.0059120434216142215,
        -0.04037537989801088,
        -0.0011250930720086982,
        0.00032365201213213624,
        -0.0041035260455342115,
        -0.007735104276692439,
        -0.0037830330677748325,
        -0.0005907990320910272
      ]
    }
  },
  "statistical_tests": {
    "permutation_test": {
      "metric": "delta_nll",
      "observed_mean": 12.011480347256398,
      "p_value": 0.0001,
      "n_permutations": 9999,
      "direction": "higher",
      "sided": "one",
      "null_distribution_mean": 0.005329985371968545,
      "null_distribution_std": 2.64226904298624
    }
  }
}