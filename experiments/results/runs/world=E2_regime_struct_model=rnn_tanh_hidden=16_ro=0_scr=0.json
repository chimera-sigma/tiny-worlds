{
  "metadata": {
    "timestamp": "2025-11-28T11:34:35.769697",
    "world_id": "E2_regime_struct",
    "world_type": "regime_markov",
    "model_id": "rnn_tanh",
    "model_type": "rnn_tanh",
    "time_cond_type": "constant_time",
    "readout_only": false,
    "scramble_core": false,
    "n_seeds": 20,
    "master_seed": 1234,
    "device": "cuda",
    "output_dir": "D:\\tiny_world_model"
  },
  "hyperparameters": {
    "hidden_dim": 16,
    "learning_rate": 0.001,
    "batch_size": 64,
    "max_steps": 20000,
    "n_train_seqs": 20000,
    "n_eval_seqs": 2000,
    "sequence_length": 128
  },
  "per_seed_results": [
    {
      "seed": 1234,
      "seed_index": 0,
      "avg_nll_model": 33.47051439468504,
      "avg_nll_baseline": 47.48059940944882,
      "delta_nll": 14.010085014763781,
      "n_eval_samples": 254000,
      "probe_r2_trained": -0.0011131319223429692,
      "probe_mse_trained": 0.2502792775630951,
      "probe_r2_random": -6.421355188934719e-05,
      "probe_mse_random": 0.25001704692840576,
      "probe_r2_permuted": -0.002398202956948259,
      "probe_mse_permuted": 0.25060054659843445
    },
    {
      "seed": 1235,
      "seed_index": 1,
      "avg_nll_model": 32.436835506889764,
      "avg_nll_baseline": 47.48059940944882,
      "delta_nll": 15.043763902559057,
      "n_eval_samples": 254000,
      "probe_r2_trained": 0.6835502742557356,
      "probe_mse_trained": 0.07911274582147598,
      "probe_r2_random": -4.847561607901341e-06,
      "probe_mse_random": 0.2500022053718567,
      "probe_r2_permuted": -0.009235901423916726,
      "probe_mse_permuted": 0.25230997800827026
    },
    {
      "seed": 1236,
      "seed_index": 2,
      "avg_nll_model": 32.088831323818894,
      "avg_nll_baseline": 47.48059940944882,
      "delta_nll": 15.391768085629927,
      "n_eval_samples": 254000,
      "probe_r2_trained": 0.7100232740082741,
      "probe_mse_trained": 0.07249446958303452,
      "probe_r2_random": 1.5920865681362528e-07,
      "probe_mse_random": 0.2500009536743164,
      "probe_r2_permuted": -0.0029460866744848158,
      "probe_mse_permuted": 0.2507375180721283
    },
    {
      "seed": 1237,
      "seed_index": 3,
      "avg_nll_model": 33.62255388779528,
      "avg_nll_baseline": 47.48059940944882,
      "delta_nll": 13.858045521653544,
      "n_eval_samples": 254000,
      "probe_r2_trained": 0.03013424050843838,
      "probe_mse_trained": 0.24246740341186523,
      "probe_r2_random": -2.8210117388738354e-06,
      "probe_mse_random": 0.2500016987323761,
      "probe_r2_permuted": -0.017369995762993806,
      "probe_mse_permuted": 0.25434350967407227
    },
    {
      "seed": 1238,
      "seed_index": 4,
      "avg_nll_model": 32.12386707984744,
      "avg_nll_baseline": 47.48059940944882,
      "delta_nll": 15.356732329601378,
      "n_eval_samples": 254000,
      "probe_r2_trained": 0.6970817563467666,
      "probe_mse_trained": 0.0757298618555069,
      "probe_r2_random": 4.8617592290134404e-05,
      "probe_mse_random": 0.2499888390302658,
      "probe_r2_permuted": -0.0039941705832278185,
      "probe_mse_permuted": 0.2509995400905609
    },
    {
      "seed": 1239,
      "seed_index": 5,
      "avg_nll_model": 32.30816736897145,
      "avg_nll_baseline": 47.48059940944882,
      "delta_nll": 15.172432040477368,
      "n_eval_samples": 254000,
      "probe_r2_trained": 0.6302873879159887,
      "probe_mse_trained": 0.09242852032184601,
      "probe_r2_random": 9.045988664513338e-05,
      "probe_mse_random": 0.24997837841510773,
      "probe_r2_permuted": -0.0024276475344571224,
      "probe_mse_permuted": 0.2506079077720642
    },
    {
      "seed": 1240,
      "seed_index": 6,
      "avg_nll_model": 32.29897480930118,
      "avg_nll_baseline": 47.48059940944882,
      "delta_nll": 15.181624600147643,
      "n_eval_samples": 254000,
      "probe_r2_trained": 0.6505627809381369,
      "probe_mse_trained": 0.08735965192317963,
      "probe_r2_random": 3.467016083846808e-05,
      "probe_mse_random": 0.24999232590198517,
      "probe_r2_permuted": -0.003371781355799852,
      "probe_mse_permuted": 0.25084394216537476
    },
    {
      "seed": 1241,
      "seed_index": 7,
      "avg_nll_model": 33.63306514517716,
      "avg_nll_baseline": 47.48059940944882,
      "delta_nll": 13.847534264271658,
      "n_eval_samples": 254000,
      "probe_r2_trained": 0.04230683150566372,
      "probe_mse_trained": 0.23942424356937408,
      "probe_r2_random": 3.9259700247762375e-05,
      "probe_mse_random": 0.24999117851257324,
      "probe_r2_permuted": -0.001843405128093556,
      "probe_mse_permuted": 0.2504618465900421
    },
    {
      "seed": 1242,
      "seed_index": 8,
      "avg_nll_model": 33.35925163016732,
      "avg_nll_baseline": 47.48059940944882,
      "delta_nll": 14.1213477792815,
      "n_eval_samples": 254000,
      "probe_r2_trained": 0.24587418308193598,
      "probe_mse_trained": 0.18853220343589783,
      "probe_r2_random": 2.7696445112690427e-05,
      "probe_mse_random": 0.24999406933784485,
      "probe_r2_permuted": -0.00563257654794147,
      "probe_mse_permuted": 0.2514091432094574
    },
    {
      "seed": 1243,
      "seed_index": 9,
      "avg_nll_model": 32.39052595964567,
      "avg_nll_baseline": 47.48059940944882,
      "delta_nll": 15.09007344980315,
      "n_eval_samples": 254000,
      "probe_r2_trained": 0.6275417108654744,
      "probe_mse_trained": 0.0931149423122406,
      "probe_r2_random": 2.6981192217667704e-05,
      "probe_mse_random": 0.24999424815177917,
      "probe_r2_permuted": -0.007476736928771155,
      "probe_mse_permuted": 0.25187018513679504
    },
    {
      "seed": 1244,
      "seed_index": 10,
      "avg_nll_model": 33.62694398991142,
      "avg_nll_baseline": 47.48059940944882,
      "delta_nll": 13.853655419537404,
      "n_eval_samples": 254000,
      "probe_r2_trained": -0.01563491144864515,
      "probe_mse_trained": 0.25390973687171936,
      "probe_r2_random": 4.4862514591681446e-05,
      "probe_mse_random": 0.24998977780342102,
      "probe_r2_permuted": -0.002213667710049494,
      "probe_mse_permuted": 0.2505544126033783
    },
    {
      "seed": 1245,
      "seed_index": 11,
      "avg_nll_model": 32.653091781496066,
      "avg_nll_baseline": 47.48059940944882,
      "delta_nll": 14.827507627952755,
      "n_eval_samples": 254000,
      "probe_r2_trained": 0.2551571523835371,
      "probe_mse_trained": 0.1862114518880844,
      "probe_r2_random": 7.049240999423834e-05,
      "probe_mse_random": 0.24998337030410767,
      "probe_r2_permuted": -0.0010623489668011299,
      "probe_mse_permuted": 0.25026658177375793
    },
    {
      "seed": 1246,
      "seed_index": 12,
      "avg_nll_model": 32.25059088951772,
      "avg_nll_baseline": 47.48059940944882,
      "delta_nll": 15.230008519931104,
      "n_eval_samples": 254000,
      "probe_r2_trained": 0.6988248574539795,
      "probe_mse_trained": 0.07529408484697342,
      "probe_r2_random": -3.989495346079508e-05,
      "probe_mse_random": 0.25001096725463867,
      "probe_r2_permuted": -0.003578847068889779,
      "probe_mse_permuted": 0.2508957087993622
    },
    {
      "seed": 1247,
      "seed_index": 13,
      "avg_nll_model": 33.692248954232284,
      "avg_nll_baseline": 47.48059940944882,
      "delta_nll": 13.788350455216538,
      "n_eval_samples": 254000,
      "probe_r2_trained": 0.36988180939350956,
      "probe_mse_trained": 0.15753017365932465,
      "probe_r2_random": 6.4353155979191e-05,
      "probe_mse_random": 0.24998490512371063,
      "probe_r2_permuted": -0.006193215608771618,
      "probe_mse_permuted": 0.25154930353164673
    },
    {
      "seed": 1248,
      "seed_index": 14,
      "avg_nll_model": 31.961845795398624,
      "avg_nll_baseline": 47.48059940944882,
      "delta_nll": 15.518753614050198,
      "n_eval_samples": 254000,
      "probe_r2_trained": 0.7002635290477767,
      "probe_mse_trained": 0.07493441551923752,
      "probe_r2_random": 2.787525833636284e-05,
      "probe_mse_random": 0.24999402463436127,
      "probe_r2_permuted": -0.0031641195986307213,
      "probe_mse_permuted": 0.2507920265197754
    },
    {
      "seed": 1249,
      "seed_index": 15,
      "avg_nll_model": 32.14587841412401,
      "avg_nll_baseline": 47.48059940944882,
      "delta_nll": 15.334720995324808,
      "n_eval_samples": 254000,
      "probe_r2_trained": 0.7148901229253939,
      "probe_mse_trained": 0.07127775251865387,
      "probe_r2_random": 3.2524402153621956e-05,
      "probe_mse_random": 0.24999286234378815,
      "probe_r2_permuted": -0.00021095960417105708,
      "probe_mse_permuted": 0.250053733587265
    },
    {
      "seed": 1250,
      "seed_index": 16,
      "avg_nll_model": 33.612556963582676,
      "avg_nll_baseline": 47.48059940944882,
      "delta_nll": 13.868042445866145,
      "n_eval_samples": 254000,
      "probe_r2_trained": -0.012892035805302848,
      "probe_mse_trained": 0.2532240152359009,
      "probe_r2_random": 3.6696710707495583e-05,
      "probe_mse_random": 0.24999181926250458,
      "probe_r2_permuted": -0.001388265869269656,
      "probe_mse_permuted": 0.2503480613231659
    },
    {
      "seed": 1251,
      "seed_index": 17,
      "avg_nll_model": 33.61597114911417,
      "avg_nll_baseline": 47.48059940944882,
      "delta_nll": 13.864628260334648,
      "n_eval_samples": 254000,
      "probe_r2_trained": 0.012136272308239549,
      "probe_mse_trained": 0.2469669133424759,
      "probe_r2_random": 2.066549710022514e-06,
      "probe_mse_random": 0.2500004768371582,
      "probe_r2_permuted": -0.011576447313845994,
      "probe_mse_permuted": 0.2528951168060303
    },
    {
      "seed": 1252,
      "seed_index": 18,
      "avg_nll_model": 31.973021053764764,
      "avg_nll_baseline": 47.48059940944882,
      "delta_nll": 15.507578355684057,
      "n_eval_samples": 254000,
      "probe_r2_trained": 0.7404268864406385,
      "probe_mse_trained": 0.06489353626966476,
      "probe_r2_random": -0.00011988406888008285,
      "probe_mse_random": 0.2500309646129608,
      "probe_r2_permuted": -0.005830463182212808,
      "probe_mse_permuted": 0.25145861506462097
    },
    {
      "seed": 1253,
      "seed_index": 19,
      "avg_nll_model": 31.978556348425197,
      "avg_nll_baseline": 47.48059940944882,
      "delta_nll": 15.502043061023624,
      "n_eval_samples": 254000,
      "probe_r2_trained": 0.7351817581486986,
      "probe_mse_trained": 0.06620482355356216,
      "probe_r2_random": 7.949267558915452e-05,
      "probe_mse_random": 0.2499811202287674,
      "probe_r2_permuted": -0.004289331611213143,
      "probe_mse_permuted": 0.25107333064079285
    }
  ],
  "aggregated_metrics": {
    "delta_nll": {
      "mean": 14.718434787155516,
      "std": 0.6884108419460564,
      "min": 13.788350455216538,
      "max": 15.518753614050198,
      "values": [
        14.010085014763781,
        15.043763902559057,
        15.391768085629927,
        13.858045521653544,
        15.356732329601378,
        15.172432040477368,
        15.181624600147643,
        13.847534264271658,
        14.1213477792815,
        15.09007344980315,
        13.853655419537404,
        14.827507627952755,
        15.230008519931104,
        13.788350455216538,
        15.518753614050198,
        15.334720995324808,
        13.868042445866145,
        13.864628260334648,
        15.507578355684057,
        15.502043061023624
      ]
    },
    "probe_r2_trained": {
      "mean": 0.42572423741759485,
      "std": 0.30748361189879236,
      "values": [
        -0.0011131319223429692,
        0.6835502742557356,
        0.7100232740082741,
        0.03013424050843838,
        0.6970817563467666,
        0.6302873879159887,
        0.6505627809381369,
        0.04230683150566372,
        0.24587418308193598,
        0.6275417108654744,
        -0.01563491144864515,
        0.2551571523835371,
        0.6988248574539795,
        0.36988180939350956,
        0.7002635290477767,
        0.7148901229253939,
        -0.012892035805302848,
        0.012136272308239549,
        0.7404268864406385,
        0.7351817581486986
      ]
    },
    "probe_r2_random": {
      "mean": 1.9727335774671894e-05,
      "std": 4.886123862618247e-05,
      "values": [
        -6.421355188934719e-05,
        -4.847561607901341e-06,
        1.5920865681362528e-07,
        -2.8210117388738354e-06,
        4.8617592290134404e-05,
        9.045988664513338e-05,
        3.467016083846808e-05,
        3.9259700247762375e-05,
        2.7696445112690427e-05,
        2.6981192217667704e-05,
        4.4862514591681446e-05,
        7.049240999423834e-05,
        -3.989495346079508e-05,
        6.4353155979191e-05,
        2.787525833636284e-05,
        3.2524402153621956e-05,
        3.6696710707495583e-05,
        2.066549710022514e-06,
        -0.00011988406888008285,
        7.949267558915452e-05
      ]
    },
    "probe_r2_permuted": {
      "mean": -0.0048102085715244994,
      "std": 0.003990688867485054,
      "values": [
        -0.002398202956948259,
        -0.009235901423916726,
        -0.0029460866744848158,
        -0.017369995762993806,
        -0.0039941705832278185,
        -0.0024276475344571224,
        -0.003371781355799852,
        -0.001843405128093556,
        -0.00563257654794147,
        -0.007476736928771155,
        -0.002213667710049494,
        -0.0010623489668011299,
        -0.003578847068889779,
        -0.006193215608771618,
        -0.0031641195986307213,
        -0.00021095960417105708,
        -0.001388265869269656,
        -0.011576447313845994,
        -0.005830463182212808,
        -0.004289331611213143
      ]
    },
    "probe_emergence_margin": {
      "description": "trained R\u00b2 minus max(random, permuted) R\u00b2",
      "mean": 0.42570451008182014,
      "values": [
        -0.001048918370453622,
        0.6835551218173435,
        0.7100231147996173,
        0.030137061520177255,
        0.6970331387544765,
        0.6301969280293436,
        0.6505281107772984,
        0.04226757180541596,
        0.2458464866368233,
        0.6275147296732567,
        -0.01567977396323683,
        0.25508665997354285,
        0.6988647524074403,
        0.3698174562375304,
        0.7002356537894403,
        0.7148575985232403,
        -0.012928732516010344,
        0.012134205758529526,
        0.7405467705095186,
        0.7351022654731094
      ]
    }
  },
  "statistical_tests": {
    "permutation_test": {
      "metric": "delta_nll",
      "observed_mean": 14.718434787155516,
      "p_value": 0.0001,
      "n_permutations": 9999,
      "direction": "higher",
      "sided": "one",
      "null_distribution_mean": 0.0032907943271873893,
      "null_distribution_std": 3.2368826357208342
    }
  }
}