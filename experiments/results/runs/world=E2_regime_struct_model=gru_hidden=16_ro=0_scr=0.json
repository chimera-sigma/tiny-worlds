{
  "metadata": {
    "timestamp": "2025-11-28T12:13:30.665792",
    "world_id": "E2_regime_struct",
    "world_type": "regime_markov",
    "model_id": "gru",
    "model_type": "gru",
    "time_cond_type": "constant_time",
    "readout_only": false,
    "scramble_core": false,
    "n_seeds": 20,
    "master_seed": 1234,
    "device": "cuda",
    "output_dir": "D:\\tiny_world_model"
  },
  "hyperparameters": {
    "hidden_dim": 16,
    "learning_rate": 0.001,
    "batch_size": 64,
    "max_steps": 20000,
    "n_train_seqs": 20000,
    "n_eval_seqs": 2000,
    "sequence_length": 128
  },
  "per_seed_results": [
    {
      "seed": 1234,
      "seed_index": 0,
      "avg_nll_model": 31.71332869402067,
      "avg_nll_baseline": 47.54923895792323,
      "delta_nll": 15.835910263902559,
      "n_eval_samples": 254000,
      "probe_r2_trained": 0.7844763767239208,
      "probe_mse_trained": 0.053881119936704636,
      "probe_r2_random": 7.424748769280232e-05,
      "probe_mse_random": 0.24998243153095245,
      "probe_r2_permuted": -0.005409894479978528,
      "probe_mse_permuted": 0.2513534724712372
    },
    {
      "seed": 1235,
      "seed_index": 1,
      "avg_nll_model": 31.565136303518702,
      "avg_nll_baseline": 47.54923895792323,
      "delta_nll": 15.984102654404527,
      "n_eval_samples": 254000,
      "probe_r2_trained": 0.819008503371484,
      "probe_mse_trained": 0.04524805396795273,
      "probe_r2_random": 4.283596472254292e-05,
      "probe_mse_random": 0.2499902844429016,
      "probe_r2_permuted": -0.026661726912558192,
      "probe_mse_permuted": 0.2566664516925812
    },
    {
      "seed": 1236,
      "seed_index": 2,
      "avg_nll_model": 31.726063207431103,
      "avg_nll_baseline": 47.54923895792323,
      "delta_nll": 15.823175750492126,
      "n_eval_samples": 254000,
      "probe_r2_trained": 0.8094984710779382,
      "probe_mse_trained": 0.047625571489334106,
      "probe_r2_random": -0.0007122326747197594,
      "probe_mse_random": 0.2501790523529053,
      "probe_r2_permuted": -0.02191650078978502,
      "probe_mse_permuted": 0.2554801404476166
    },
    {
      "seed": 1237,
      "seed_index": 3,
      "avg_nll_model": 31.52305038139764,
      "avg_nll_baseline": 47.54923895792323,
      "delta_nll": 16.02618857652559,
      "n_eval_samples": 254000,
      "probe_r2_trained": 0.8232902605194273,
      "probe_mse_trained": 0.04417761042714119,
      "probe_r2_random": 5.541249479223964e-05,
      "probe_mse_random": 0.2499871402978897,
      "probe_r2_permuted": -0.0055485343327841274,
      "probe_mse_permuted": 0.2513881325721741
    },
    {
      "seed": 1238,
      "seed_index": 4,
      "avg_nll_model": 31.522698480561022,
      "avg_nll_baseline": 47.54923895792323,
      "delta_nll": 16.026540477362207,
      "n_eval_samples": 254000,
      "probe_r2_trained": 0.8176226412830978,
      "probe_mse_trained": 0.04559452086687088,
      "probe_r2_random": 2.9901808205501368e-05,
      "probe_mse_random": 0.24999351799488068,
      "probe_r2_permuted": -0.00365585596391349,
      "probe_mse_permuted": 0.25091496109962463
    },
    {
      "seed": 1239,
      "seed_index": 5,
      "avg_nll_model": 31.685111343503937,
      "avg_nll_baseline": 47.54923895792323,
      "delta_nll": 15.864127614419292,
      "n_eval_samples": 254000,
      "probe_r2_trained": 0.7667576551747946,
      "probe_mse_trained": 0.058310817927122116,
      "probe_r2_random": 3.8604051760815494e-05,
      "probe_mse_random": 0.24999134242534637,
      "probe_r2_permuted": -0.0007475184842042903,
      "probe_mse_permuted": 0.25018787384033203
    },
    {
      "seed": 1240,
      "seed_index": 6,
      "avg_nll_model": 31.532614911417323,
      "avg_nll_baseline": 47.54923895792323,
      "delta_nll": 16.016624046505907,
      "n_eval_samples": 254000,
      "probe_r2_trained": 0.8123778110131975,
      "probe_mse_trained": 0.04690573364496231,
      "probe_r2_random": 6.2984626718609604e-06,
      "probe_mse_random": 0.24999941885471344,
      "probe_r2_permuted": -0.0004921732007048263,
      "probe_mse_permuted": 0.2501240372657776
    },
    {
      "seed": 1241,
      "seed_index": 7,
      "avg_nll_model": 31.61500036909449,
      "avg_nll_baseline": 47.54923895792323,
      "delta_nll": 15.934238588828741,
      "n_eval_samples": 254000,
      "probe_r2_trained": 0.8200560955438616,
      "probe_mse_trained": 0.04498615488409996,
      "probe_r2_random": 6.512801328206752e-05,
      "probe_mse_random": 0.2499847114086151,
      "probe_r2_permuted": -0.001544667835633451,
      "probe_mse_permuted": 0.25038716197013855
    },
    {
      "seed": 1242,
      "seed_index": 8,
      "avg_nll_model": 31.538665015994095,
      "avg_nll_baseline": 47.54923895792323,
      "delta_nll": 16.010573941929135,
      "n_eval_samples": 254000,
      "probe_r2_trained": 0.8202545186178042,
      "probe_mse_trained": 0.04493654891848564,
      "probe_r2_random": 3.616027103636732e-05,
      "probe_mse_random": 0.24999195337295532,
      "probe_r2_permuted": -0.0007144976422206462,
      "probe_mse_permuted": 0.25017961859703064
    },
    {
      "seed": 1243,
      "seed_index": 9,
      "avg_nll_model": 32.12254835137795,
      "avg_nll_baseline": 47.54923895792323,
      "delta_nll": 15.426690606545279,
      "n_eval_samples": 254000,
      "probe_r2_trained": 0.7329459968078803,
      "probe_mse_trained": 0.06676376610994339,
      "probe_r2_random": 5.8213901964143666e-05,
      "probe_mse_random": 0.2499864399433136,
      "probe_r2_permuted": -0.0001779387621874129,
      "probe_mse_permuted": 0.2500454783439636
    },
    {
      "seed": 1244,
      "seed_index": 10,
      "avg_nll_model": 31.584435439222442,
      "avg_nll_baseline": 47.54923895792323,
      "delta_nll": 15.964803518700787,
      "n_eval_samples": 254000,
      "probe_r2_trained": 0.7996117836296878,
      "probe_mse_trained": 0.050097253173589706,
      "probe_r2_random": -0.00016506421007811412,
      "probe_mse_random": 0.25004225969314575,
      "probe_r2_permuted": -0.0009039204505680853,
      "probe_mse_permuted": 0.2502269744873047
    },
    {
      "seed": 1245,
      "seed_index": 11,
      "avg_nll_model": 31.5296477300689,
      "avg_nll_baseline": 47.54923895792323,
      "delta_nll": 16.01959122785433,
      "n_eval_samples": 254000,
      "probe_r2_trained": 0.8330792116398023,
      "probe_mse_trained": 0.0417303629219532,
      "probe_r2_random": -0.00011070499006149426,
      "probe_mse_random": 0.25002866983413696,
      "probe_r2_permuted": -0.0017413623817463808,
      "probe_mse_permuted": 0.25043633580207825
    },
    {
      "seed": 1246,
      "seed_index": 12,
      "avg_nll_model": 31.565490434301182,
      "avg_nll_baseline": 47.54923895792323,
      "delta_nll": 15.983748523622047,
      "n_eval_samples": 254000,
      "probe_r2_trained": 0.8352608372771335,
      "probe_mse_trained": 0.04118495434522629,
      "probe_r2_random": 9.016186460553133e-05,
      "probe_mse_random": 0.2499784529209137,
      "probe_r2_permuted": -0.009916941388731226,
      "probe_mse_permuted": 0.25248023867607117
    },
    {
      "seed": 1247,
      "seed_index": 13,
      "avg_nll_model": 31.57305088890256,
      "avg_nll_baseline": 47.54923895792323,
      "delta_nll": 15.976188069020669,
      "n_eval_samples": 254000,
      "probe_r2_trained": 0.8088314083467794,
      "probe_mse_trained": 0.04779233783483505,
      "probe_r2_random": -0.0001937935346922881,
      "probe_mse_random": 0.2500494420528412,
      "probe_r2_permuted": -0.019309284778852742,
      "probe_mse_permuted": 0.2548283338546753
    },
    {
      "seed": 1248,
      "seed_index": 14,
      "avg_nll_model": 31.632622754675197,
      "avg_nll_baseline": 47.54923895792323,
      "delta_nll": 15.916616203248033,
      "n_eval_samples": 254000,
      "probe_r2_trained": 0.810234764328888,
      "probe_mse_trained": 0.047441497445106506,
      "probe_r2_random": 8.491667670917913e-05,
      "probe_mse_random": 0.24997976422309875,
      "probe_r2_permuted": -0.010427274329282588,
      "probe_mse_permuted": 0.2526078224182129
    },
    {
      "seed": 1249,
      "seed_index": 15,
      "avg_nll_model": 31.71470163324311,
      "avg_nll_baseline": 47.54923895792323,
      "delta_nll": 15.83453732468012,
      "n_eval_samples": 254000,
      "probe_r2_trained": 0.7922132970908694,
      "probe_mse_trained": 0.05194688215851784,
      "probe_r2_random": 1.523912385881232e-05,
      "probe_mse_random": 0.24999718368053436,
      "probe_r2_permuted": -0.0042136340131637695,
      "probe_mse_permuted": 0.25105440616607666
    },
    {
      "seed": 1250,
      "seed_index": 16,
      "avg_nll_model": 31.658451556348425,
      "avg_nll_baseline": 47.54923895792323,
      "delta_nll": 15.890787401574805,
      "n_eval_samples": 254000,
      "probe_r2_trained": 0.7995955563296334,
      "probe_mse_trained": 0.05010131001472473,
      "probe_r2_random": 2.465662030914917e-05,
      "probe_mse_random": 0.24999482929706573,
      "probe_r2_permuted": -0.006602817099950142,
      "probe_mse_permuted": 0.25165170431137085
    },
    {
      "seed": 1251,
      "seed_index": 17,
      "avg_nll_model": 31.6911625246063,
      "avg_nll_baseline": 47.54923895792323,
      "delta_nll": 15.858076433316931,
      "n_eval_samples": 254000,
      "probe_r2_trained": 0.7978236066889905,
      "probe_mse_trained": 0.05054429918527603,
      "probe_r2_random": 6.23266061101635e-05,
      "probe_mse_random": 0.24998541176319122,
      "probe_r2_permuted": -0.0017184742891078741,
      "probe_mse_permuted": 0.2504306137561798
    },
    {
      "seed": 1252,
      "seed_index": 18,
      "avg_nll_model": 31.499219303641734,
      "avg_nll_baseline": 47.54923895792323,
      "delta_nll": 16.050019654281495,
      "n_eval_samples": 254000,
      "probe_r2_trained": 0.8358810360425707,
      "probe_mse_trained": 0.041029904037714005,
      "probe_r2_random": 3.1451522811143384e-05,
      "probe_mse_random": 0.24999313056468964,
      "probe_r2_permuted": -0.0013567947418915427,
      "probe_mse_permuted": 0.25034019351005554
    },
    {
      "seed": 1253,
      "seed_index": 19,
      "avg_nll_model": 31.57821186023622,
      "avg_nll_baseline": 47.54923895792323,
      "delta_nll": 15.97102709768701,
      "n_eval_samples": 254000,
      "probe_r2_trained": 0.8009460432019232,
      "probe_mse_trained": 0.04976368695497513,
      "probe_r2_random": 2.5848708467335335e-05,
      "probe_mse_random": 0.24999453127384186,
      "probe_r2_permuted": -0.0014456053096818522,
      "probe_mse_permuted": 0.2503623962402344
    }
  ],
  "aggregated_metrics": {
    "delta_nll": {
      "mean": 15.920678398745077,
      "std": 0.13380025322743133,
      "min": 15.426690606545279,
      "max": 16.050019654281495,
      "values": [
        15.835910263902559,
        15.984102654404527,
        15.823175750492126,
        16.02618857652559,
        16.026540477362207,
        15.864127614419292,
        16.016624046505907,
        15.934238588828741,
        16.010573941929135,
        15.426690606545279,
        15.964803518700787,
        16.01959122785433,
        15.983748523622047,
        15.976188069020669,
        15.916616203248033,
        15.83453732468012,
        15.890787401574805,
        15.858076433316931,
        16.050019654281495,
        15.97102709768701
      ]
    },
    "probe_r2_trained": {
      "mean": 0.8059882937354841,
      "std": 0.023737792202273116,
      "values": [
        0.7844763767239208,
        0.819008503371484,
        0.8094984710779382,
        0.8232902605194273,
        0.8176226412830978,
        0.7667576551747946,
        0.8123778110131975,
        0.8200560955438616,
        0.8202545186178042,
        0.7329459968078803,
        0.7996117836296878,
        0.8330792116398023,
        0.8352608372771335,
        0.8088314083467794,
        0.810234764328888,
        0.7922132970908694,
        0.7995955563296334,
        0.7978236066889905,
        0.8358810360425707,
        0.8009460432019232
      ]
    },
    "probe_r2_random": {
      "mean": -2.2019591527600025e-05,
      "std": 0.00017580362591765737,
      "values": [
        7.424748769280232e-05,
        4.283596472254292e-05,
        -0.0007122326747197594,
        5.541249479223964e-05,
        2.9901808205501368e-05,
        3.8604051760815494e-05,
        6.2984626718609604e-06,
        6.512801328206752e-05,
        3.616027103636732e-05,
        5.8213901964143666e-05,
        -0.00016506421007811412,
        -0.00011070499006149426,
        9.016186460553133e-05,
        -0.0001937935346922881,
        8.491667670917913e-05,
        1.523912385881232e-05,
        2.465662030914917e-05,
        6.23266061101635e-05,
        3.1451522811143384e-05,
        2.5848708467335335e-05
      ]
    },
    "probe_r2_permuted": {
      "mean": -0.006225270859347309,
      "std": 0.007567218114831791,
      "values": [
        -0.005409894479978528,
        -0.026661726912558192,
        -0.02191650078978502,
        -0.0055485343327841274,
        -0.00365585596391349,
        -0.0007475184842042903,
        -0.0004921732007048263,
        -0.001544667835633451,
        -0.0007144976422206462,
        -0.0001779387621874129,
        -0.0009039204505680853,
        -0.0017413623817463808,
        -0.009916941388731226,
        -0.019309284778852742,
        -0.010427274329282588,
        -0.0042136340131637695,
        -0.006602817099950142,
        -0.0017184742891078741,
        -0.0013567947418915427,
        -0.0014456053096818522
      ]
    },
    "probe_emergence_margin": {
      "description": "trained R\u00b2 minus max(random, permuted) R\u00b2",
      "mean": 0.806010313327012,
      "values": [
        0.784402129236228,
        0.8189656674067615,
        0.8102107037526579,
        0.8232348480246351,
        0.8175927394748923,
        0.7667190511230337,
        0.8123715125505256,
        0.8199909675305795,
        0.8202183583467678,
        0.7328877829059162,
        0.7997768478397659,
        0.8331899166298637,
        0.835170675412528,
        0.8090252018814716,
        0.8101498476521788,
        0.7921980579670106,
        0.7995708997093243,
        0.7977612800828804,
        0.8358495845197595,
        0.8009201944934559
      ]
    }
  },
  "statistical_tests": {
    "permutation_test": {
      "metric": "delta_nll",
      "observed_mean": 15.920678398745077,
      "p_value": 0.0001,
      "n_permutations": 9999,
      "direction": "higher",
      "sided": "one",
      "null_distribution_mean": 0.006440510192597754,
      "null_distribution_std": 3.497861563825617
    }
  }
}